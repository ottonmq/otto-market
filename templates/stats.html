{% extends "base.html" %}
{% block content %}
<div class="container py-4">
    <div class="row mb-5 align-items-center">
        <div class="col-md-4 d-flex justify-content-center">
            <div class="clock-container">
                <div class="clock">
                    <div class="hand hour" id="hour"></div>
                    <div class="hand minute" id="minute"></div>
                    <div class="hand second" id="second"></div>
                    <div class="center-dot"></div>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <h2 class="text-white mb-0 fw-900" style="letter-spacing:6px; font-weight:900; text-shadow: 0 0 15px rgba(0,242,255,0.4);">GLOBAL_MARKET</h2>
            <p class="text-info fw-bold mb-0" id="digital-date" style="letter-spacing: 2px;">{{ now|date:"l, Y-m-d"|upper }}</p>
            <p class="text-info opacity-75 small" id="digital-clock">--:--:-- PM CST</p>
        </div>
    </div>

    <div class="row g-3 mb-5">
        <div class="col-md-4 col-6">
            <div class="otto-card-premium">
                <div class="scanner-line"></div>
                <div class="otto-card-content">
                    <small class="text-muted fw-bold d-block" style="font-size:10px; letter-spacing: 1px;">TOTAL_ANUNCIOS</small>
                    <div class="d-flex align-items-center gap-2">
                        <i class="bi bi- megaphone-fill text-info"></i>
                        <h2 class="text-white fw-bold mb-0">{{ total|default:"0" }}</h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4 col-6">
            <div class="otto-card-premium">
                <div class="scanner-line"></div>
                <div class="otto-card-content">
                    <small class="text-muted fw-bold d-block" style="font-size:10px; letter-spacing: 1px;">OPERACIONES_VENDIDAS</small>
                    <div class="d-flex align-items-center gap-2">
                        <i class="bi bi-cart-check-fill text-info"></i>
                        <h2 class="text-white fw-bold mb-0">{{ vendidos|default:"0" }}</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="otto-card-premium p-4">
        <div class="scanner-line"></div>
        <h5 class="text-white mb-4 fw-bold" style="letter-spacing:3px;">
            <span class="status-dot-blink"></span> DISTRIBUCIÓN_GLOBAL
        </h5>
        <div class="row align-items-center">
            <div class="col-md-6 mb-4 d-flex justify-content-center">
                <div style="width:100%;max-width:280px;height:280px;">
                    <canvas id="donutChart"></canvas>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <small class="text-info d-block mb-3 fw-bold text-center" style="letter-spacing: 2px;">TENDENCIAS_GLOBALES</small>
                <div style="width:100%;height:220px;">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="otto-card-premium py-2 px-3 mt-4" style="border-radius: 15px;">
        <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center text-white" style="font-family: monospace; font-size: 11px; letter-spacing: 2px;">
                <i class="bi bi-info-circle me-2 text-info"></i> DATOS_SINC_RED_OK (60S)
            </div>
            <div class="status-dot-blink"></div>
        </div>
    </div>
</div>

<style>
    body { background:#000!important; font-family:'Courier New',monospace; color: #fff; }

    /* ESTILO ESTÁNDAR OTTO-CARD-PREMIUM */
    .otto-card-premium {
        background: #0a0a0a;
        border: 1px solid #00f2ff; /* Borde cian neón */
        border-radius: 25px;       /* Curvatura premium */
        position: relative;
        overflow: hidden;
        box-shadow: 0 0 15px rgba(0, 242, 255, 0.15);
        padding: 20px;
        transition: transform 0.3s ease;
    }
    .otto-card-premium:hover { transform: translateY(-5px); }

    /* ESCÁNER LÁSER VERTICAL */
    .scanner-line {
        position: absolute;
        width: 100%;
        height: 2px;
        background: linear-gradient(90deg, transparent, #00f2ff, transparent);
        top: -2px;
        left: 0;
        animation: scan-vertical 4s linear infinite;
        z-index: 5;
        opacity: 0.6;
    }

    @keyframes scan-vertical {
        0%, 100% { top: 0%; opacity: 0; }
        50% { top: 100%; opacity: 1; }
    }

    /* RELOJ ANALÓGICO */
    .clock { width:110px; height:110px; border:3px solid #00f2ff; border-radius:50%; position:relative; box-shadow:0 0 20px rgba(0,242,255,0.4); background: #050505; }
    .hand { position:absolute; bottom:50%; left:50%; transform-origin:bottom; background:#00f2ff; transform:translateX(-50%); border-radius: 10px; }
    .hour { width:4px; height:30px; } .minute { width:3px; height:45px; } 
    .second { width:1px; height:50px; background:#f05; box-shadow:0 0 8px #f05; }
    .center-dot { position:absolute; top:50%; left:50%; width:8px; height:8px; background:#fff; border-radius:50%; transform:translate(-50%,-50%); box-shadow: 0 0 5px #fff; }

    /* DOT PARPADEANTE */
    .status-dot-blink { display:inline-block; width:8px; height:8px; background:#00f2ff; border-radius:50%; animation:blink 1.5s infinite; }
    @keyframes blink { 0%,100% { opacity:1; box-shadow:0 0 10px #00f2ff; } 50% { opacity:.2; } }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Lógica del Reloj
    function updateClock() {
        const n = new Date();
        document.getElementById('second').style.transform = `translateX(-50%) rotate(${n.getSeconds()*6}deg)`;
        document.getElementById('minute').style.transform = `translateX(-50%) rotate(${n.getMinutes()*6}deg)`;
        document.getElementById('hour').style.transform = `translateX(-50%) rotate(${(n.getHours()%12)*30+n.getMinutes()/2}deg)`;
        document.getElementById('digital-clock').innerText = n.toLocaleTimeString() + " CST";
    }
    setInterval(updateClock, 1000); updateClock();

    // Gráficos con colores Neon
    const lbs = [{% for c in categorias %}"{{ c.nombre|upper }}"{% if not forloop.last %},{% endif %}{% endfor %}];
    const dta = [{% for c in categorias %}{{ c.num }}{% if not forloop.last %},{% endif %}{% endfor %}];

    new Chart(document.getElementById('donutChart'), {
        type: 'doughnut',
        data: { labels: lbs, datasets: [{ data: dta, backgroundColor: ['#0055ff','#00f2ff','#7000ff','#ff0055','#00ffaa'], borderColor:'#0a0a0a', borderWidth:5 }] },
        options: { responsive:true, maintainAspectRatio:false, cutout:'75%', plugins:{legend:{position:'bottom',labels:{color:'#888',font:{size:9, family:'monospace'}}}} }
    });

    new Chart(document.getElementById('radarChart'), {
        type: 'radar',
        data: { labels: lbs, datasets: [{ label:'SISTEMA', data: dta, borderColor:'#00f2ff', backgroundColor:'rgba(0,242,255,0.1)', borderWidth:2, pointBackgroundColor:'#00f2ff' }] },
        options: { responsive:true, maintainAspectRatio:false, scales:{r:{grid:{color:'#222'},angleLines:{color:'#222'},ticks:{display:false},pointLabels:{color:'#00f2ff',font:{size:9, family:'monospace'}}}}, plugins:{legend:{display:false}} }
    });
</script>

<div class="otto-static-btn" onclick="window.history.back()">
    <div class="particles-box">
        <span class="p"></span><span class="p"></span><span class="p"></span><span class="p"></span><span class="p"></span>
    </div>
    <div class="btn-content">
        <span class="scan-line-btn"></span>
        <span class="btn-arrow">⟸</span>
        <span class="btn-text">VOLVER</span>
    </div>
</div>

<style>
    /* CONTENEDOR DEL BOTÓN */
    .otto-static-btn {
        position: relative; /* YA NO ES FIXED */
        width: 160px;
        height: 48px;
        background: #000;
        border: 2px solid #00f2ff;
        border-radius: 4px;
        cursor: pointer;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: 0.3s all;
        margin: 10px 0; /* Espacio para que no pegue con lo demás */
    }

    .btn-content {
        display: flex;
        align-items: center;
        gap: 10px;
        color: #00f2ff;
        font-family: 'Courier New', monospace;
        font-weight: bold;
        z-index: 5;
    }

    /* EFECTO ESCÁNER */
    .scan-line-btn {
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(0, 242, 255, 0.4), transparent);
        animation: scan-loop 2.5s infinite linear;
    }

    @keyframes scan-loop {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    /* PARTÍCULAS */
    .particles-box .p {
        position: absolute;
        width: 2px;
        height: 2px;
        background: #00f2ff;
        border-radius: 50%;
        opacity: 0;
        animation: float-up 2s infinite linear;
    }

    .particles-box .p:nth-child(1) { left: 20%; animation-delay: 0s; }
    .particles-box .p:nth-child(2) { left: 40%; animation-delay: 0.5s; }
    .particles-box .p:nth-child(3) { left: 60%; animation-delay: 1s; }
    .particles-box .p:nth-child(4) { left: 80%; animation-delay: 1.5s; }
    .particles-box .p:nth-child(5) { left: 50%; animation-delay: 0.7s; }

    @keyframes float-up {
        0% { transform: translateY(25px); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateY(-35px); opacity: 0; }
    }

    /* EFECTO AL TOCAR */
    .otto-static-btn:active {
        transform: scale(0.95);
        box-shadow: 0 0 20px rgba(0, 242, 255, 0.5);
    }
    
    .otto-static-btn:hover {
        background: rgba(0, 242, 255, 0.1);
    }
</style>



<div style="margin-bottom: 150px; display: block; width: 100%; height: 1px;"></div>

<style>
    /* Forzamos a que el último elemento tenga aire abajo */
    main, section, .container {
        padding-bottom: 100px !important;
    }
</style>


{% endblock %}
